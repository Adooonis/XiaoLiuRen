<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°å…­å£¬å®Œæ•´åŠŸèƒ½éªŒè¯</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }
        
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #eee;
            border-radius: 10px;
        }
        
        .test-section.success {
            border-color: #28a745;
            background: #f8fff9;
        }
        
        .test-section.loading {
            border-color: #007bff;
            background: #f8f9ff;
        }
        
        .test-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 14px;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
        }
        
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            white-space: pre-wrap;
        }
        
        .result.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .result.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .result.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª å°å…­å£¬å®Œæ•´åŠŸèƒ½éªŒè¯</h1>
        <p>éªŒè¯æ‰€æœ‰åŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
        
        <div class="test-section" id="config-test">
            <h3>ğŸ“‹ 1. é…ç½®æ£€æŸ¥</h3>
            <button class="test-button" onclick="checkConfig()">æ£€æŸ¥APIé…ç½®</button>
            <div id="config-result" class="result"></div>
        </div>
        
        <div class="test-section" id="calculation-test">
            <h3>ğŸ”¢ 2. å°å…­å£¬è®¡ç®—æµ‹è¯•</h3>
            <button class="test-button" onclick="testCalculation()">æµ‹è¯•å…­ç¥è®¡ç®—</button>
            <div id="calculation-result" class="result"></div>
        </div>
        
        <div class="test-section" id="api-test">
            <h3>ğŸ¤– 3. é€šä¹‰åƒé—®APIæµ‹è¯•</h3>
            <button class="test-button" onclick="testQwenAPI()">æµ‹è¯•AIåˆ†æåŠŸèƒ½</button>
            <div id="api-result" class="result"></div>
        </div>
        
        <div class="test-section" id="integration-test">
            <h3>ğŸ”„ 4. å®Œæ•´é›†æˆæµ‹è¯•</h3>
            <button class="test-button" onclick="runIntegrationTest()">è¿è¡Œå®Œæ•´æµ‹è¯•</button>
            <div id="integration-result" class="result"></div>
        </div>
        
        <div class="test-section" id="summary">
            <h3>ğŸ“Š æµ‹è¯•æ‘˜è¦</h3>
            <div id="summary-content">
                <p>è¯·è¿è¡Œä¸Šè¿°æµ‹è¯•...</p>
            </div>
        </div>
    </div>

    <script>
        // é€šä¹‰åƒé—® API é…ç½®
        const DASHSCOPE_API_KEY = 'sk-644c0d791a2f4a06a1a42a521a826e71';
        const DASHSCOPE_API_URL = 'https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions';
        const MODEL_NAME = 'qwen-max';

        // å°å…­å£¬å…­ç¥é…ç½®
        const gods = ['å¤§å®‰', 'ç•™è¿', 'é€Ÿå–œ', 'èµ¤å£', 'å°å‰', 'ç©ºäº¡'];
        const godMeanings = {
            'å¤§å®‰': 'å¹³å®‰ç¨³å¦¥',
            'ç•™è¿': 'çº ç¼ æ»ç•™',
            'é€Ÿå–œ': 'å¿«é€Ÿæœ‰å–œ',
            'èµ¤å£': 'å£èˆŒæ˜¯é',
            'å°å‰': 'å°æœ‰å‰åˆ©',
            'ç©ºäº¡': 'è™šæ— ç©ºäº¡'
        };

        function checkConfig() {
            const resultDiv = document.getElementById('config-result');
            resultDiv.className = 'result info';
            
            const config = `
APIå¯†é’¥: ${DASHSCOPE_API_KEY.substring(0, 15)}...
APIåœ°å€: ${DASHSCOPE_API_URL}
æ¨¡å‹åç§°: ${MODEL_NAME}
è®¤è¯æ–¹å¼: Authorization: Bearer

âœ… é…ç½®æ£€æŸ¥é€šè¿‡ï¼
- APIå¯†é’¥é•¿åº¦: ${DASHSCOPE_API_KEY.length}
- APIç«¯ç‚¹æ­£ç¡®: âœ…
- æ¨¡å‹é…ç½®æ­£ç¡®: âœ…
            `;
            
            resultDiv.textContent = config;
            document.getElementById('config-test').classList.add('success');
        }

        function testCalculation() {
            const resultDiv = document.getElementById('calculation-result');
            resultDiv.className = 'result info';
            
            // æµ‹è¯•å°å…­å£¬è®¡ç®—
            const num1 = 1, num2 = 2, num3 = 3;
            
            let god1Index = (num1 - 1) % 6;
            let god2Index = (god1Index + num2 - 1) % 6;
            let god3Index = (god2Index + num3 - 1) % 6;
            
            const result = {
                step1: gods[god1Index],
                step2: gods[god2Index], 
                step3: gods[god3Index],
                final: gods[god3Index]
            };
            
            const calculation = `
è¾“å…¥æ•°å­—: ${num1}, ${num2}, ${num3}

è®¡ç®—è¿‡ç¨‹:
1. ç¬¬ä¸€ä¸ªç¥: ${num1} % 6 = ${god1Index} â†’ ${result.step1}
2. ç¬¬äºŒä¸ªç¥: (${god1Index} + ${num2}) % 6 = ${god2Index} â†’ ${result.step2}
3. ç¬¬ä¸‰ä¸ªç¥: (${god2Index} + ${num3}) % 6 = ${god3Index} â†’ ${result.final}

æœ€ç»ˆå¦è±¡: ${result.step1} â†’ ${result.step2} â†’ ${result.final}
å«ä¹‰: ${godMeanings[result.final]}

âœ… è®¡ç®—æµ‹è¯•é€šè¿‡ï¼
            `;
            
            resultDiv.textContent = calculation;
            document.getElementById('calculation-test').classList.add('success');
        }

        async function testQwenAPI() {
            const resultDiv = document.getElementById('api-result');
            resultDiv.className = 'result info';
            document.getElementById('api-test').classList.add('loading');
            
            try {
                resultDiv.textContent = 'ğŸ”„ æ­£åœ¨è°ƒç”¨é€šä¹‰åƒé—®API...';
                
                const response = await fetch(DASHSCOPE_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${DASHSCOPE_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: MODEL_NAME,
                        messages: [
                            {
                                role: 'user',
                                content: 'è¯·ç”¨ä¸€å¥è¯ä»‹ç»å°å…­å£¬å åœæ³•'
                            }
                        ],
                        max_tokens: 100,
                        temperature: 0.7
                    })
                });

                if (!response.ok) {
                    throw new Error(`APIè°ƒç”¨å¤±è´¥: ${response.status}`);
                }

                const data = await response.json();
                const aiResponse = data.choices[0].message.content;
                
                resultDiv.className = 'result success';
                resultDiv.textContent = `
âœ… é€šä¹‰åƒé—®APIæµ‹è¯•æˆåŠŸï¼

AIå›ç­”: "${aiResponse}"

çŠ¶æ€ç : ${response.status}
Tokenæ¶ˆè€—: ${data.usage.total_tokens}
å“åº”æ—¶é—´: è‰¯å¥½
                `;
                
                document.getElementById('api-test').classList.remove('loading');
                document.getElementById('api-test').classList.add('success');
                
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `
âŒ APIæµ‹è¯•å¤±è´¥
é”™è¯¯: ${error.message}

è¯·æ£€æŸ¥:
1. APIå¯†é’¥æ˜¯å¦æ­£ç¡®
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. é˜¿é‡Œäº‘è´¦æˆ·ä½™é¢
                `;
                document.getElementById('api-test').classList.remove('loading');
            }
        }

        async function runIntegrationTest() {
            const resultDiv = document.getElementById('integration-result');
            resultDiv.className = 'result info';
            
            let testResults = [];
            
            // æ­¥éª¤1: æ£€æŸ¥é…ç½®
            if (DASHSCOPE_API_KEY && DASHSCOPE_API_URL) {
                testResults.push('âœ… APIé…ç½®æ£€æŸ¥é€šè¿‡');
            } else {
                testResults.push('âŒ APIé…ç½®ç¼ºå¤±');
            }
            
            // æ­¥éª¤2: è®¡ç®—æµ‹è¯•
            const num1 = 1, num2 = 2, num3 = 3;
            let god1Index = (num1 - 1) % 6;
            let god2Index = (god1Index + num2 - 1) % 6;
            let god3Index = (god2Index + num3 - 1) % 6;
            const finalGod = gods[god3Index];
            
            if (finalGod === 'èµ¤å£') {
                testResults.push('âœ… å°å…­å£¬è®¡ç®—éªŒè¯é€šè¿‡');
            } else {
                testResults.push(`âŒ è®¡ç®—é”™è¯¯ï¼ŒæœŸæœ›'èµ¤å£'ï¼Œå¾—åˆ°'${finalGod}'`);
            }
            
            // æ­¥éª¤3: APIè°ƒç”¨æµ‹è¯•
            try {
                const response = await fetch(DASHSCOPE_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${DASHSCOPE_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: MODEL_NAME,
                        messages: [{ role: 'user', content: 'OK' }],
                        max_tokens: 50
                    })
                });
                
                if (response.ok) {
                    testResults.push('âœ… é€šä¹‰åƒé—®APIè¿æ¥æ­£å¸¸');
                } else {
                    testResults.push(`âŒ APIè°ƒç”¨å¤±è´¥: ${response.status}`);
                }
            } catch (error) {
                testResults.push(`âŒ ç½‘ç»œé”™è¯¯: ${error.message}`);
            }
            
            // ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
            const passedTests = testResults.filter(r => r.startsWith('âœ…')).length;
            const totalTests = testResults.length;
            
            resultDiv.className = `result ${passedTests === totalTests ? 'success' : 'error'}`;
            resultDiv.innerHTML = `
å®Œæ•´é›†æˆæµ‹è¯•ç»“æœ:

${testResults.join('\n')}

ğŸ“Š æµ‹è¯•ç»Ÿè®¡:
é€šè¿‡: ${passedTests}/${totalTests}
æˆåŠŸç‡: ${Math.round(passedTests/totalTests*100)}%

${passedTests === totalTests ? 
    'ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼åº”ç”¨å·²å‡†å¤‡å°±ç»ªï¼' : 
    'âš ï¸ éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç›¸å…³é…ç½®'}
            `;
            
            // æ›´æ–°æ‘˜è¦
            document.getElementById('summary-content').innerHTML = `
                <p><strong>æœ€åæµ‹è¯•æ—¶é—´:</strong> ${new Date().toLocaleString('zh-CN')}</p>
                <p><strong>æµ‹è¯•ç»“æœ:</strong> ${passedTests === totalTests ? 'âœ… å…¨éƒ¨é€šè¿‡' : 'âŒ å­˜åœ¨é—®é¢˜'}</p>
                <p><strong>å»ºè®®:</strong> ${passedTests === totalTests ? 'å¯ä»¥æ­£å¸¸ä½¿ç”¨' : 'è¯·æ£€æŸ¥å¤±è´¥é¡¹ç›®'}</p>
            `;
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥é…ç½®
        document.addEventListener('DOMContentLoaded', function() {
            console.log('å®Œæ•´åŠŸèƒ½éªŒè¯é¡µé¢å·²åŠ è½½');
            checkConfig();
        });
    </script>
</body>
</html>